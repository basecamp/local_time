!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).LocalTime=t()}(this,(function(){"use strict";var e;e={config:{},run:function(){return this.getController().processElements()},process:function(...e){var t,r,n;for(r=0,n=e.length;r<n;r++)t=e[r],this.getController().processElement(t);return e.length},getController:function(){return null!=this.controller?this.controller:this.controller=new e.Controller}};var t,r,n,s,a,i,o,u,l,c,d,h,m,f,g,v,p,b,y,S,T,M,E,D,w,O,N,A,I,C,$,L,k,F,U,W,Y,P=e;return P.config.useFormat24=!1,P.config.i18n={en:{date:{dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbrDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbrMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],yesterday:"yesterday",today:"today",tomorrow:"tomorrow",on:"on {date}",formats:{default:"%b %e, %Y",thisYear:"%b %e"}},time:{am:"am",pm:"pm",singular:"a {time}",singularAn:"an {time}",elapsed:"{time} ago",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",formats:{default:"%l:%M%P",default_24h:"%H:%M"}},datetime:{at:"{date} at {time}",formats:{default:"%B %e, %Y at %l:%M%P %Z",default_24h:"%B %e, %Y at %H:%M %Z"}}}},P.config.locale="en",P.config.defaultLocale="en",P.config.timerInterval=6e4,n=!isNaN(Date.parse("2011-01-01T12:00:00-05:00")),P.parseDate=function(e){return e=e.toString(),n||(e=r(e)),new Date(Date.parse(e))},t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|[-+]?[\d:]+)$/,r=function(e){var r,n,s,a,i,o,u,l,c,d;if(a=e.match(t))return[r,c,o,n,s,i,l,d]=a,"Z"!==d&&(u=d.replace(":","")),`${c}/${o}/${n} ${s}:${i}:${l} GMT${[u]}`},P.elementMatchesSelector=(s=document.documentElement,a=null!=(i=null!=(o=null!=(u=null!=(l=s.matches)?l:s.matchesSelector)?u:s.webkitMatchesSelector)?o:s.mozMatchesSelector)?i:s.msMatchesSelector,function(e,t){if((null!=e?e.nodeType:void 0)===Node.ELEMENT_NODE)return a.call(e,t)}),({config:c}=P),({i18n:h}=c),P.getI18nValue=function(e="",{locale:t}={locale:c.locale}){var r;return null!=(r=d(h[t],e))?r:t!==c.defaultLocale?P.getI18nValue(e,{locale:c.defaultLocale}):void 0},P.translate=function(e,t={},r){var n,s,a;for(n in a=P.getI18nValue(e,r),t)s=t[n],a=a.replace(`{${n}}`,s);return a},d=function(e,t){var r,n,s,a,i;for(i=e,r=0,s=(a=t.split(".")).length;r<s;r++){if(null==i[n=a[r]])return null;i=i[n]}return i},({getI18nValue:f,translate:M}=P),T="function"==typeof("undefined"!=typeof Intl&&null!==Intl?Intl.DateTimeFormat:void 0),g={"Central European Standard Time":"CET","Central European Summer Time":"CEST","China Standard Time":"CST","Israel Daylight Time":"IDT","Israel Standard Time":"IST","Moscow Standard Time":"MSK","Philippine Standard Time":"PHT","Singapore Standard Time":"SGT","Western Indonesia Time":"WIB"},P.knownEdgeCaseTimeZones=g,P.strftime=S=function(e,t){var r,n,s,a,i,o,u;return n=e.getDay(),r=e.getDate(),i=e.getMonth(),u=e.getFullYear(),s=e.getHours(),a=e.getMinutes(),o=e.getSeconds(),t.replace(/%(-?)([%aAbBcdeHIlmMpPSwyYZ])/g,(function(t,l,c){switch(c){case"%":return"%";case"a":return f("date.abbrDayNames")[n];case"A":return f("date.dayNames")[n];case"b":return f("date.abbrMonthNames")[i];case"B":return f("date.monthNames")[i];case"c":return e.toString();case"d":return v(r,l);case"e":return r;case"H":return v(s,l);case"I":return v(S(e,"%l"),l);case"l":return 0===s||12===s?12:(s+12)%12;case"m":return v(i+1,l);case"M":return v(a,l);case"p":return M("time."+(s>11?"pm":"am")).toUpperCase();case"P":return M("time."+(s>11?"pm":"am"));case"S":return v(o,l);case"w":return n;case"y":return v(u%100,l);case"Y":return u;case"Z":return p(e)}}))},v=function(e,t){return"-"===t?e:`0${e}`.slice(-2)},p=function(e){var t,r,n;return(r=m(e))?g[r]:(n=y(e,{allowGMT:!1}))||(n=b(e))?n:(t=y(e,{allowGMT:!0}))?t:""},m=function(e){return Object.keys(g).find((function(t){return T?new Date(e).toLocaleString("en-US",{timeZoneName:"long"}).includes(t):e.toString().includes(t)}))},y=function(e,{allowGMT:t}){var r;if(T&&(r=new Date(e).toLocaleString("en-US",{timeZoneName:"short"}).split(" ").pop(),t||!r.includes("GMT")))return r},b=function(e){var t,r,n,s,a;return(t=null!=(r=(a=e.toString()).match(/\(([\w\s]+)\)$/))?r[1]:void 0)?/\s/.test(t)?t.match(/\b(\w)/g).join(""):t:(t=null!=(n=a.match(/(\w{3,4})\s\d{4}$/))?n[1]:void 0)||(t=null!=(s=a.match(/(UTC[\+\-]\d+)/))?s[1]:void 0)?t:void 0},P.CalendarDate=class{static fromDate(e){return new this(e.getFullYear(),e.getMonth()+1,e.getDate())}static today(){return this.fromDate(new Date)}constructor(e,t,r){this.date=new Date(Date.UTC(e,t-1)),this.date.setUTCDate(r),this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate(),this.value=this.date.getTime()}equals(e){return(null!=e?e.value:void 0)===this.value}is(e){return this.equals(e)}isToday(){return this.is(this.constructor.today())}occursOnSameYearAs(e){return this.year===(null!=e?e.year:void 0)}occursThisYear(){return this.occursOnSameYearAs(this.constructor.today())}daysSince(e){if(e)return(this.date-e.date)/864e5}daysPassed(){return this.constructor.today().daysSince(this)}},({strftime:w,translate:O,getI18nValue:D,config:E}=P),P.RelativeTime=class{constructor(e){this.date=e,this.calendarDate=P.CalendarDate.fromDate(this.date)}toString(){var e,t;return(t=this.toTimeElapsedString())?O("time.elapsed",{time:t}):(e=this.toWeekdayString())?(t=this.toTimeString(),O("datetime.at",{date:e,time:t})):O("date.on",{date:this.toDateString()})}toTimeOrDateString(){return this.calendarDate.isToday()?this.toTimeString():this.toDateString()}toTimeElapsedString(){var e,t,r,n,s;return r=(new Date).getTime()-this.date.getTime(),n=Math.round(r/1e3),t=Math.round(n/60),e=Math.round(t/60),r<0?null:n<10?(s=O("time.second"),O("time.singular",{time:s})):n<45?`${n} ${O("time.seconds")}`:n<90?(s=O("time.minute"),O("time.singular",{time:s})):t<45?`${t} ${O("time.minutes")}`:t<90?(s=O("time.hour"),O("time.singularAn",{time:s})):e<24?`${e} ${O("time.hours")}`:""}toWeekdayString(){switch(this.calendarDate.daysPassed()){case 0:return O("date.today");case 1:return O("date.yesterday");case-1:return O("date.tomorrow");case 2:case 3:case 4:case 5:case 6:return w(this.date,"%A");default:return""}}toDateString(){var e;return e=this.calendarDate.occursThisYear()?D("date.formats.thisYear"):D("date.formats.default"),w(this.date,e)}toTimeString(){var e;return e=E.useFormat24?"default_24h":"default",w(this.date,D(`time.formats.${e}`))}},({elementMatchesSelector:N}=P),P.PageObserver=class{constructor(e,t){this.processMutations=this.processMutations.bind(this),this.processInsertion=this.processInsertion.bind(this),this.selector=e,this.callback=t}start(){if(!this.started)return this.observeWithMutationObserver()||this.observeWithMutationEvent(),this.started=!0}observeWithMutationObserver(){if("undefined"!=typeof MutationObserver&&null!==MutationObserver)return new MutationObserver(this.processMutations).observe(document.documentElement,{childList:!0,subtree:!0}),!0}observeWithMutationEvent(){return addEventListener("DOMNodeInserted",this.processInsertion,!1),!0}findSignificantElements(e){var t;return t=[],(null!=e?e.nodeType:void 0)===Node.ELEMENT_NODE&&(N(e,this.selector)&&t.push(e),t.push(...e.querySelectorAll(this.selector))),t}processMutations(e){var t,r,n,s,a,i,o,u;for(t=[],r=0,s=e.length;r<s;r++)if("childList"===(i=e[r]).type)for(n=0,a=(u=i.addedNodes).length;n<a;n++)o=u[n],t.push(...this.findSignificantElements(o));return this.notify(t)}processInsertion(e){var t;return t=this.findSignificantElements(e.target),this.notify(t)}notify(e){if(null!=e?e.length:void 0)return"function"==typeof this.callback?this.callback(e):void 0}},({elementMatchesSelector:A}=P),P.ElementObserver=class{constructor(e,t){this.processMutations=this.processMutations.bind(this),this.selector=e,this.callback=t}start(){if(!this.started)return this.observeWithMutationObserver(),this.started=!0}observeWithMutationObserver(){return new MutationObserver(this.processMutations).observe(document.documentElement,{childList:!0,subtree:!0})}processMutations(e){var t,r,n,s,a;for(a=[],t=0,r=e.length;t<r;t++)if("childList"===(n=e[t]).type)a.push(function(){var e,t,r,a;for(a=[],e=0,t=(r=n.removedNodes).length;e<t;e++)s=r[e],A(s,this.selector)?a.push(this.callback(s)):a.push(void 0);return a}.call(this));else a.push(void 0);return a}},({parseDate:L,strftime:k,getI18nValue:$,config:I,elementMatchesSelector:C}=P),P.Controller=function(){var e,t,r,n,s,a;return e=`${r="time[data-local]"}:not([data-localized])`,t={characterData:!0,subtree:!0,attributes:!0,attributeFilter:["datetime","data-local","data-format","data-format24"]},s=function(e){return e.setAttribute("data-observed","")},n=function(e){return e.setAttribute("data-localized","")},a=function(e){return new P.RelativeTime(e)},class{constructor(){this.processElements=this.processElements.bind(this),this.disconnectObserver=this.disconnectObserver.bind(this),this.observe=this.observe.bind(this),this.processMutations=this.processMutations.bind(this),this.processLingeringElement=this.processLingeringElement.bind(this),this.incrementUpdates=this.incrementUpdates.bind(this),this.observedElements=new Map,this.pageObserver=new P.PageObserver(e,this.processElements),this.elementObserver=new P.ElementObserver(r,this.disconnectObserver)}start(){if(!this.started)return this.processElements(),this.startTimer(),this.pageObserver.start(),this.elementObserver.start(),this.started=!0}startTimer(){var e;if(e=I.timerInterval)return null!=this.timer?this.timer:this.timer=setInterval(this.processElements,e)}processElements(t=document.querySelectorAll(e)){var r,n,s;for(n=0,s=t.length;n<s;n++)r=t[n],this.processElement(r);return t.length}disconnectObserver(e){var t,r;if(t=null!=(r=this.observedElements.get(e))?r.observer:void 0)return t.disconnect(),this.observedElements.delete(e)}processElement(e){var t,r,s,i,o,u;if(t=e.getAttribute("datetime"),s=e.getAttribute("data-local"),r=I.useFormat24&&e.getAttribute("data-format24")||e.getAttribute("data-format"),i=L(t),!isNaN(i))return e.hasAttribute("title")||(u=I.useFormat24?"default_24h":"default",o=k(i,$(`datetime.formats.${u}`)),e.setAttribute("title",o)),e.textContent=function(){switch(s){case"time":return n(e),k(i,r);case"date":return n(e),a(i).toDateString();case"time-ago":return a(i).toString();case"time-or-date":return a(i).toTimeOrDateString();case"weekday":return a(i).toWeekdayString();case"weekday-or-date":return a(i).toWeekdayString()||a(i).toDateString()}}(),this.observe(e)}observe(e){var r;if(!e.hasAttribute("data-observed"))return s(e),(r=new MutationObserver(this.processMutations)).observe(e,t),this.observedElements.set(e,{observer:r,updates:-1}),this.incrementUpdates(e)}processMutations(e){var t,n,s,a,i;for(a=[],n=0,s=e.length;n<s;n++){if(t=(i=e[n].target).nodeType===Node.TEXT_NODE?i.parentNode:i,C(t,r)){this.processLingeringElement(t);break}a.push(void 0)}return a}processLingeringElement(e){return s(e),this.incrementUpdates(e),this.processElement(e)}incrementUpdates(e){return this.observedElements.get(e).updates++,e.setAttribute("data-updates",this.observedElements.get(e).updates)}}}.call(window),Y=!1,F=function(){return document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState},U=function(e){var t;return null!=(t="function"==typeof requestAnimationFrame?requestAnimationFrame(e):void 0)?t:setTimeout(e,17)},W=function(){return P.getController().start()},P.start=function(){return Y?P.run():(Y=!0,"undefined"!=typeof MutationObserver&&null!==MutationObserver||F()?W():U(W))},window.LocalTime===P&&P.start(),P}));
